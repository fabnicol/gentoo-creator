<p><strong>USAGE:</strong><br />
<strong>mkg</strong> [1]<br />
<strong>mkg</strong> [[switch=argument]…] filename.iso [2]<br />
<strong>mkg</strong> [[switch=argument]…] [3]<br />
<strong>mkg</strong> help[=md] [4]</p>
<p>Usage [1] and [2] create a bootable ISO output file with a current Gentoo distribution.<br />
For [1], implicit ISO output name is <strong>gentoo.iso</strong><br />
Usage [3] creates a VirtualBox VDI dynamic disk and a virtual machine with name Gentoo.<br />
Usage [4] prints this help, in markdown form if argument ‘md’ is specified.<br />
Warning: you should have at least 55 GB of free disk space in the current directory or in vmpath if specified.</p>
<p><strong>Switches:</strong></p>
<p>Boolean values are either ‘true’ or ‘false’. For example, to build a minimal distribution, specify:<br />
&gt; minimal=true</p>
<p>on command line.</p>
<p>Type Conventions:<br />
b: true/false Boolean<br />
o: on/off Boolean<br />
n: Integer<br />
f: Filepath<br />
d: Directory path<br />
e: Email address<br />
s: String<br />
u: URL</p>
<p>When a field depends on another, a colon separates the type and the name of the dependency.</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 28%" />
<col style="width: 20%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Option</th>
<th style="text-align: center;">Description</th>
<th style="text-align: center;">Default value</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">debug_mode</td>
<td style="text-align: center;">Do not clean up gentoolize custom logs at root of gentoo system files before VM shutdown. Boolean.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">verbose</td>
<td style="text-align: center;">Increase verbosity</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">bios</td>
<td style="text-align: center;">Type of bootloader: BIOS or EFI (default)</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">blank</td>
<td style="text-align: center;">Blank rewritable optical disk before burning installation image.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">build_virtualbox</td>
<td style="text-align: center;">Download code source and automatically build virtualbox and tools. Yields VirtualBox and vbox-img executables under main directory and subdirectory virtualbox with the build, including documentation.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">burn</td>
<td style="text-align: center;">Burn to optical disc. Boolean.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cdrecord</td>
<td style="text-align: center;">cdrecord full path. Automatically determined if left unspecified.</td>
<td style="text-align: center;">[<code>which cdrecord</code>]</td>
<td style="text-align: center;">f:burn</td>
</tr>
<tr class="even">
<td style="text-align: center;">cflags</td>
<td style="text-align: center;">GCC CFLAGS options for ebuilds</td>
<td style="text-align: center;">[-march=native -O2]</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">cleanup</td>
<td style="text-align: center;">Clean up archives, temporary images and virtual machine after successful completion. Boolean.</td>
<td style="text-align: center;">[true]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">compact</td>
<td style="text-align: center;">Compact virtual disk after VM building. Caution: this may impede hot_install and ext_device.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">CRAN_REPOS</td>
<td style="text-align: center;">CRAN repository URL for downloading extra R packages</td>
<td style="text-align: center;">[https://cloud.r-project.org]</td>
<td style="text-align: center;">s</td>
</tr>
<tr class="even">
<td style="text-align: center;">remove_vdi</td>
<td style="text-align: center;">Full clean-up: also remove VDI disks</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">clonezilla_install</td>
<td style="text-align: center;">Use the CloneZilla live CD instead of the official Gentoo minimal install CD. May be more robust for headless install, owing to a VB bug requiring artificial keyboard input (see doc).</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">cloning_method</td>
<td style="text-align: center;">Method used by hot_install ext_device=… to intall Gentoo to disk. One of: ‘guestfish’ (default), ‘with-raw-buffer’ (slower) or ‘vbox-img’ (currently unavailable)</td>
<td style="text-align: center;">[guestfish]</td>
<td style="text-align: center;">s:ext_device</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cpuexecutioncap</td>
<td style="text-align: center;">Maximum percentage of CPU per core (0 to 100)</td>
<td style="text-align: center;">[100]</td>
<td style="text-align: center;">n</td>
</tr>
<tr class="even">
<td style="text-align: center;">create_squashfs</td>
<td style="text-align: center;">(Re)create the squashfs filesystem. Boolean.</td>
<td style="text-align: center;">[true]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">device_installer</td>
<td style="text-align: center;">Create Gentoo clone installer on external device. <strong>ext_device</strong> value must be specified.</td>
<td style="text-align: center;">[]</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">disable_md5_check</td>
<td style="text-align: center;">Disable MD5 checkums verification after downloads. Boolean.</td>
<td style="text-align: center;">[true]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">download</td>
<td style="text-align: center;">Download install ISO image from Gentoo mirror. Boolean.</td>
<td style="text-align: center;">[true]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">download_clonezilla</td>
<td style="text-align: center;">Refresh CloneZilla ISO download. An ISO file must have been downloaded to create the recovery image of the Gentoo platform once the virtual machine has ended its job. Boolean</td>
<td style="text-align: center;">[true]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">download_clonezilla_path</td>
<td style="text-align: center;">Download the following CloneZilla ISO</td>
<td style="text-align: center;">[path1]</td>
<td style="text-align: center;">u</td>
</tr>
<tr class="even">
<td style="text-align: center;">download_rstudio</td>
<td style="text-align: center;">Download and build RStudio. Boolean.</td>
<td style="text-align: center;">[true]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">download_arch</td>
<td style="text-align: center;">Download and install stage3 archive to virtual disk. Booelan.</td>
<td style="text-align: center;">[true]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">elist</td>
<td style="text-align: center;">File containing a list of Gentoo ebuilds to add to the VM on top of stage3. Note: if the default value is not used, adjust the names of the ‘elist’.accept_keywords and ‘elist’.use files</td>
<td style="text-align: center;">[ebuilds.list]</td>
<td style="text-align: center;">f</td>
</tr>
<tr class="odd">
<td style="text-align: center;">email</td>
<td style="text-align: center;">Email address to send warning to when Gentoo has been created.</td>
<td style="text-align: center;">[]</td>
<td style="text-align: center;">e</td>
</tr>
<tr class="even">
<td style="text-align: center;">email_passwd</td>
<td style="text-align: center;">Email password</td>
<td style="text-align: center;">[]</td>
<td style="text-align: center;">s:email</td>
</tr>
<tr class="odd">
<td style="text-align: center;">emirrors</td>
<td style="text-align: center;">Mirror sites for downloading ebuilds</td>
<td style="text-align: center;">[path2]</td>
<td style="text-align: center;">u</td>
</tr>
<tr class="even">
<td style="text-align: center;">ext_device</td>
<td style="text-align: center;">Create Gentoo OS on external device. Argument is either a device label (e.g. sdb, hdb), or a mountpoint directory (if mounted), or a few consecutive letters of the vendor name (e.g. ‘Samsu’, ‘PNY’ or ‘Kingst’), if there is just one such. Requires <em>hot_install</em> on commandline.</td>
<td style="text-align: center;">[]</td>
<td style="text-align: center;">s</td>
</tr>
<tr class="odd">
<td style="text-align: center;">force</td>
<td style="text-align: center;">Forcefully creates machine even if others with same same exist. Stops and restarts VBox daemons. Not advised if other VMs are running.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">from_device</td>
<td style="text-align: center;">Do not Generate Gentoo but use the external device on which Gentoo was previously installed. Boolean.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b:ext_device</td>
</tr>
<tr class="odd">
<td style="text-align: center;">from_iso</td>
<td style="text-align: center;">Do not generate Gentoo but use the bootable ISO given on commandline.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">from_vm</td>
<td style="text-align: center;">Do not generate Gentoo but use the VM. Boolean.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gui</td>
<td style="text-align: center;">Binary: true corresponds to VBoxManage startvm … –type=gui, false to –type=headless</td>
<td style="text-align: center;">[true]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">help</td>
<td style="text-align: center;">This help</td>
<td style="text-align: center;">[]</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">hot_install</td>
<td style="text-align: center;">Intall to Gentoo attached device (like /dev/sdb) possibly mounted (like /media/USER/567EAF). To be used with <em>ext_device=…</em></td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b:ext_device</td>
</tr>
<tr class="even">
<td style="text-align: center;">hwvirtex</td>
<td style="text-align: center;">Activate HWVIRTEX: on/off</td>
<td style="text-align: center;">[on]</td>
<td style="text-align: center;">o</td>
</tr>
<tr class="odd">
<td style="text-align: center;">interactive</td>
<td style="text-align: center;">Allow interaction with user. This may cause deadlock if process is detached from the console (<em>nohup</em> or other methods)</td>
<td style="text-align: center;">[true]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">ioapic</td>
<td style="text-align: center;">IOAPIC parameter: on or off</td>
<td style="text-align: center;">[on]</td>
<td style="text-align: center;">o</td>
</tr>
<tr class="odd">
<td style="text-align: center;">kernel_config</td>
<td style="text-align: center;">Use a custom kernel config file</td>
<td style="text-align: center;">[.config]</td>
<td style="text-align: center;">f</td>
</tr>
<tr class="even">
<td style="text-align: center;">language</td>
<td style="text-align: center;">Add support for non-US English language as a default. Use standard abbreviations (fr for french, es for spanish) etc.</td>
<td style="text-align: center;">[us]</td>
<td style="text-align: center;">s</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lineno_patch</td>
<td style="text-align: center;">Line patched against vbox-img.cpp in virtualbox source code</td>
<td style="text-align: center;">[797]</td>
<td style="text-align: center;">n</td>
</tr>
<tr class="even">
<td style="text-align: center;">livecd</td>
<td style="text-align: center;">Path to the live CD that will start the VM</td>
<td style="text-align: center;">[gentoo.iso]</td>
<td style="text-align: center;">f</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mem</td>
<td style="text-align: center;">VM RAM memory in MiB</td>
<td style="text-align: center;">[8000]</td>
<td style="text-align: center;">n</td>
</tr>
<tr class="even">
<td style="text-align: center;">minimal</td>
<td style="text-align: center;">Remove <em>libreoffice</em> and <em>data science tools</em> from default list of installed software. Boolean.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">minimal_size</td>
<td style="text-align: center;">Remove kernel sources to minimize packaging. Not advised for personal use but OK for deployment and distribution.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">mirror</td>
<td style="text-align: center;">Mirror site for downloading of stage3 tarball</td>
<td style="text-align: center;">[path2]</td>
<td style="text-align: center;">u</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ncpus</td>
<td style="text-align: center;">Number of VM CPUs. By default the third of available threads.</td>
<td style="text-align: center;">[count]</td>
<td style="text-align: center;">n</td>
</tr>
<tr class="even">
<td style="text-align: center;">nonroot_user</td>
<td style="text-align: center;">Non-root user</td>
<td style="text-align: center;">[fab]</td>
<td style="text-align: center;">s</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pae</td>
<td style="text-align: center;">Activate PAE: on/off</td>
<td style="text-align: center;">[on]</td>
<td style="text-align: center;">o</td>
</tr>
<tr class="even">
<td style="text-align: center;">paravirtprovider</td>
<td style="text-align: center;">Virtualization interface: kvm for GNU/Linux, may be tweaked (see VirtualBox documentation)</td>
<td style="text-align: center;">[kvm]</td>
<td style="text-align: center;">s</td>
</tr>
<tr class="odd">
<td style="text-align: center;">passwd</td>
<td style="text-align: center;">User password</td>
<td style="text-align: center;">[_user2021_]</td>
<td style="text-align: center;">s:vm</td>
</tr>
<tr class="even">
<td style="text-align: center;">processor</td>
<td style="text-align: center;">Processor type</td>
<td style="text-align: center;">[amd64]</td>
<td style="text-align: center;">s</td>
</tr>
<tr class="odd">
<td style="text-align: center;">quiet_mode</td>
<td style="text-align: center;">Silence output except for the most severe errors.</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">logging</td>
<td style="text-align: center;">Activate logging</td>
<td style="text-align: center;">[true]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="odd">
<td style="text-align: center;">remove_vdi</td>
<td style="text-align: center;">Remove virtual disk on clean-up</td>
<td style="text-align: center;">[false]</td>
<td style="text-align: center;">b</td>
</tr>
<tr class="even">
<td style="text-align: center;">rootpasswd</td>
<td style="text-align: center;">Root password</td>
<td style="text-align: center;">[_dev2021_]</td>
<td style="text-align: center;">s:vm</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rtcuseutc</td>
<td style="text-align: center;">Use UTC as time reference: on/off</td>
<td style="text-align: center;">[on]</td>
<td style="text-align: center;">o</td>
</tr>
<tr class="even">
<td style="text-align: center;">r_version</td>
<td style="text-align: center;">R version</td>
<td style="text-align: center;">[4.0.2]</td>
<td style="text-align: center;">s</td>
</tr>
<tr class="odd">
<td style="text-align: center;">scsi_address</td>
<td style="text-align: center;">In case of several optical disc burners, specify the SCSI address as x,y,z</td>
<td style="text-align: center;">[]</td>
<td style="text-align: center;">s</td>
</tr>
<tr class="even">
<td style="text-align: center;">size</td>
<td style="text-align: center;">Dynamic disc size</td>
<td style="text-align: center;">[55000]</td>
<td style="text-align: center;">n</td>
</tr>
<tr class="odd">
<td style="text-align: center;">smtp_url</td>
<td style="text-align: center;">SMTP URL of email provider for end-of-job warning. Default: gmail SMTP</td>
<td style="text-align: center;">[smtps://smtp.gmail.com:465]</td>
<td style="text-align: center;">u</td>
</tr>
<tr class="even">
<td style="text-align: center;">stage3</td>
<td style="text-align: center;">Path to stage3 archive</td>
<td style="text-align: center;">[stage3.tar.xz]</td>
<td style="text-align: center;">f</td>
</tr>
<tr class="odd">
<td style="text-align: center;">usbehci</td>
<td style="text-align: center;">Activate USB2 driver: on/off</td>
<td style="text-align: center;">[off]</td>
<td style="text-align: center;">o</td>
</tr>
<tr class="even">
<td style="text-align: center;">usbxhci</td>
<td style="text-align: center;">Activate USB3 driver: on/off. Note: if on, needs extension pack.</td>
<td style="text-align: center;">[off]</td>
<td style="text-align: center;">o</td>
</tr>
<tr class="odd">
<td style="text-align: center;">vm</td>
<td style="text-align: center;">Virtual Machine name. Unless ‘force=true’ is used, a time stamp will be appended to avoid registry issues with prior VMs of the same name.</td>
<td style="text-align: center;">[Gentoo]</td>
<td style="text-align: center;">vm</td>
</tr>
<tr class="even">
<td style="text-align: center;">vbox_version</td>
<td style="text-align: center;">Virtualbox version</td>
<td style="text-align: center;">[6.1.14]</td>
<td style="text-align: center;">s</td>
</tr>
<tr class="odd">
<td style="text-align: center;">vbox_version_full</td>
<td style="text-align: center;">Virtualbox full version</td>
<td style="text-align: center;">[6.1.14a]</td>
<td style="text-align: center;">s</td>
</tr>
<tr class="even">
<td style="text-align: center;">vbpath</td>
<td style="text-align: center;">Path to VirtualBox directory</td>
<td style="text-align: center;">[/usr/bin]</td>
<td style="text-align: center;">d</td>
</tr>
<tr class="odd">
<td style="text-align: center;">vmpath</td>
<td style="text-align: center;">Path to VM base directory</td>
<td style="text-align: center;">[$PWD]</td>
<td style="text-align: center;">d</td>
</tr>
<tr class="even">
<td style="text-align: center;">vtxvpid</td>
<td style="text-align: center;">Activate VTXVPID: on/off</td>
<td style="text-align: center;">[on]</td>
<td style="text-align: center;">o</td>
</tr>
</tbody>
</table>
<p><strong>path1:</strong> https://sourceforge.net/projects/clonezilla/files/clonezilla_live_alternative/20200703-focal/clonezilla-live-20200703-focal-amd64.iso/download<br />
<strong>path2:</strong> https://github.com/rstudio/rstudio/archive/v<br />
<strong>path3:</strong> http://gentoo.mirrors.ovh.net/gentoo-distfiles/<br />
<strong>count:</strong> nproc –all / 3</p>
